import{S as Pe,W as Ue,a as De,g as xe,b as Be,m as ue,P as Me,i as ne,c as ze,d as qe,e as Fe,p as Ie,j as He}from"./WepinModal-CfZqf5gV.js";import"./index-DbzJgILT.js";var je=["google","apple","naver","discord","facebook","line"],ke="en",be="usd",Ge=/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/i,Ke="0.0.35",fe,ie=((fe={}).WEPIN_LIFECYCLE_CHANGE="wepin_lifecycle_change",fe.SEND_IN_PROGRESS="send_in_progress",fe.SEND_COMPLETE="send_complete",fe),$e=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,ye=Math.ceil,V=Math.floor,j="[BigNumber Error] ",Oe=j+"Number primitive has more than 15 significant digits: ",Y=1e14,L=14,Ee=9007199254740991,me=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],te=1e7,z=1e9;function We(m){var y,A,i,e=v.prototype={constructor:v,toString:null,valueOf:null},p=new v(1),g=20,c=4,_=-7,S=21,E=-1e7,I=1e7,b=!1,R=1,F=0,J={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"Â ",suffix:""},re="0123456789abcdefghijklmnopqrstuvwxyz",we=!0;function v(n,t){var r,f,s,u,w,o,a,d,l=this;if(!(l instanceof v))return new v(n,t);if(t==null){if(n&&n._isBigNumber===!0){l.s=n.s,!n.c||n.e>I?l.c=l.e=null:n.e<E?l.c=[l.e=0]:(l.e=n.e,l.c=n.c.slice());return}if((o=typeof n=="number")&&n*0==0){if(l.s=1/n<0?(n=-n,-1):1,n===~~n){for(u=0,w=n;w>=10;w/=10,u++);u>I?l.c=l.e=null:(l.e=u,l.c=[n]);return}d=String(n)}else{if(!$e.test(d=String(n)))return i(l,d,o);l.s=d.charCodeAt(0)==45?(d=d.slice(1),-1):1}(u=d.indexOf("."))>-1&&(d=d.replace(".","")),(w=d.search(/e/i))>0?(u<0&&(u=w),u+=+d.slice(w+1),d=d.substring(0,w)):u<0&&(u=d.length)}else{if(T(t,2,re.length,"Base"),t==10&&we)return l=new v(n),G(l,g+l.e+1,c);if(d=String(n),o=typeof n=="number"){if(n*0!=0)return i(l,d,o,t);if(l.s=1/n<0?(d=d.slice(1),-1):1,v.DEBUG&&d.replace(/^0\.0*|\./,"").length>15)throw Error(Oe+n)}else l.s=d.charCodeAt(0)===45?(d=d.slice(1),-1):1;for(r=re.slice(0,t),u=w=0,a=d.length;w<a;w++)if(r.indexOf(f=d.charAt(w))<0){if(f=="."){if(w>u){u=a;continue}}else if(!s&&(d==d.toUpperCase()&&(d=d.toLowerCase())||d==d.toLowerCase()&&(d=d.toUpperCase()))){s=!0,w=-1,u=0;continue}return i(l,String(n),o,t)}o=!1,d=A(d,t,10,l.s),(u=d.indexOf("."))>-1?d=d.replace(".",""):u=d.length}for(w=0;d.charCodeAt(w)===48;w++);for(a=d.length;d.charCodeAt(--a)===48;);if(d=d.slice(w,++a)){if(a-=w,o&&v.DEBUG&&a>15&&(n>Ee||n!==V(n)))throw Error(Oe+l.s*n);if((u=u-w-1)>I)l.c=l.e=null;else if(u<E)l.c=[l.e=0];else{if(l.e=u,l.c=[],w=(u+1)%L,u<0&&(w+=L),w<a){for(w&&l.c.push(+d.slice(0,w)),a-=L;w<a;)l.c.push(+d.slice(w,w+=L));w=L-(d=d.slice(w)).length}else w-=a;for(;w--;d+="0");l.c.push(+d)}}else l.c=[l.e=0]}v.clone=We,v.ROUND_UP=0,v.ROUND_DOWN=1,v.ROUND_CEIL=2,v.ROUND_FLOOR=3,v.ROUND_HALF_UP=4,v.ROUND_HALF_DOWN=5,v.ROUND_HALF_EVEN=6,v.ROUND_HALF_CEIL=7,v.ROUND_HALF_FLOOR=8,v.EUCLID=9,v.config=v.set=function(n){var t,r;if(n!=null)if(typeof n=="object"){if(n.hasOwnProperty(t="DECIMAL_PLACES")&&(r=n[t],T(r,0,z,t),g=r),n.hasOwnProperty(t="ROUNDING_MODE")&&(r=n[t],T(r,0,8,t),c=r),n.hasOwnProperty(t="EXPONENTIAL_AT")&&(r=n[t],r&&r.pop?(T(r[0],-z,0,t),T(r[1],0,z,t),_=r[0],S=r[1]):(T(r,-z,z,t),_=-(S=r<0?-r:r))),n.hasOwnProperty(t="RANGE"))if(r=n[t],r&&r.pop)T(r[0],-z,-1,t),T(r[1],1,z,t),E=r[0],I=r[1];else if(T(r,-z,z,t),r)E=-(I=r<0?-r:r);else throw Error(j+t+" cannot be zero: "+r);if(n.hasOwnProperty(t="CRYPTO"))if(r=n[t],r===!!r)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))b=r;else throw b=!r,Error(j+"crypto unavailable");else b=r;else throw Error(j+t+" not true or false: "+r);if(n.hasOwnProperty(t="MODULO_MODE")&&(r=n[t],T(r,0,9,t),R=r),n.hasOwnProperty(t="POW_PRECISION")&&(r=n[t],T(r,0,z,t),F=r),n.hasOwnProperty(t="FORMAT"))if(r=n[t],typeof r=="object")J=r;else throw Error(j+t+" not an object: "+r);if(n.hasOwnProperty(t="ALPHABET"))if(r=n[t],typeof r=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(r))we=r.slice(0,10)=="0123456789",re=r;else throw Error(j+t+" invalid: "+r)}else throw Error(j+"Object expected: "+n);return{DECIMAL_PLACES:g,ROUNDING_MODE:c,EXPONENTIAL_AT:[_,S],RANGE:[E,I],CRYPTO:b,MODULO_MODE:R,POW_PRECISION:F,FORMAT:J,ALPHABET:re}},v.isBigNumber=function(n){if(!n||n._isBigNumber!==!0)return!1;if(!v.DEBUG)return!0;var t,r,f=n.c,s=n.e,u=n.s;e:if({}.toString.call(f)=="[object Array]"){if((u===1||u===-1)&&s>=-z&&s<=z&&s===V(s)){if(f[0]===0){if(s===0&&f.length===1)return!0;break e}if(t=(s+1)%L,t<1&&(t+=L),String(f[0]).length==t){for(t=0;t<f.length;t++)if(r=f[t],r<0||r>=Y||r!==V(r))break e;if(r!==0)return!0}}}else if(f===null&&s===null&&(u===null||u===1||u===-1))return!0;throw Error(j+"Invalid BigNumber: "+n)},v.maximum=v.max=function(){return Se(arguments,-1)},v.minimum=v.min=function(){return Se(arguments,1)},v.random=(function(){var n=9007199254740992,t=Math.random()*n&2097151?function(){return V(Math.random()*n)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(r){var f,s,u,w,o,a=0,d=[],l=new v(p);if(r==null?r=g:T(r,0,z),w=ye(r/L),b)if(crypto.getRandomValues){for(f=crypto.getRandomValues(new Uint32Array(w*=2));a<w;)o=f[a]*131072+(f[a+1]>>>11),o>=9e15?(s=crypto.getRandomValues(new Uint32Array(2)),f[a]=s[0],f[a+1]=s[1]):(d.push(o%1e14),a+=2);a=w/2}else if(crypto.randomBytes){for(f=crypto.randomBytes(w*=7);a<w;)o=(f[a]&31)*281474976710656+f[a+1]*1099511627776+f[a+2]*4294967296+f[a+3]*16777216+(f[a+4]<<16)+(f[a+5]<<8)+f[a+6],o>=9e15?crypto.randomBytes(7).copy(f,a):(d.push(o%1e14),a+=7);a=w/7}else throw b=!1,Error(j+"crypto unavailable");if(!b)for(;a<w;)o=t(),o<9e15&&(d[a++]=o%1e14);for(w=d[--a],r%=L,w&&r&&(o=me[L-r],d[a]=V(w/o)*o);d[a]===0;d.pop(),a--);if(a<0)d=[u=0];else{for(u=-1;d[0]===0;d.splice(0,1),u-=L);for(a=1,o=d[0];o>=10;o/=10,a++);a<L&&(u-=L-a)}return l.e=u,l.c=d,l}})(),v.sum=function(){for(var n=1,t=arguments,r=new v(t[0]);n<t.length;)r=r.plus(t[n++]);return r},A=(function(){var n="0123456789";function t(r,f,s,u){for(var w,o=[0],a,d=0,l=r.length;d<l;){for(a=o.length;a--;o[a]*=f);for(o[0]+=u.indexOf(r.charAt(d++)),w=0;w<o.length;w++)o[w]>s-1&&(o[w+1]==null&&(o[w+1]=0),o[w+1]+=o[w]/s|0,o[w]%=s)}return o.reverse()}return function(r,f,s,u,w){var o,a,d,l,h,k,O,C,D=r.indexOf("."),M=g,N=c;for(D>=0&&(l=F,F=0,r=r.replace(".",""),C=new v(f),k=C.pow(r.length-D),F=l,C.c=t(ee($(k.c),k.e,"0"),10,s,n),C.e=C.c.length),O=t(r,f,s,w?(o=re,n):(o=n,re)),d=l=O.length;O[--l]==0;O.pop());if(!O[0])return o.charAt(0);if(D<0?--d:(k.c=O,k.e=d,k.s=u,k=y(k,C,M,N,s),O=k.c,h=k.r,d=k.e),a=d+M+1,D=O[a],l=s/2,h=h||a<0||O[a+1]!=null,h=N<4?(D!=null||h)&&(N==0||N==(k.s<0?3:2)):D>l||D==l&&(N==4||h||N==6&&O[a-1]&1||N==(k.s<0?8:7)),a<1||!O[0])r=h?ee(o.charAt(1),-M,o.charAt(0)):o.charAt(0);else{if(O.length=a,h)for(--s;++O[--a]>s;)O[a]=0,a||(++d,O=[1].concat(O));for(l=O.length;!O[--l];);for(D=0,r="";D<=l;r+=o.charAt(O[D++]));r=ee(r,d,o.charAt(0))}return r}})(),y=(function(){function n(f,s,u){var w,o,a,d,l=0,h=f.length,k=s%te,O=s/te|0;for(f=f.slice();h--;)a=f[h]%te,d=f[h]/te|0,w=O*a+d*k,o=k*a+w%te*te+l,l=(o/u|0)+(w/te|0)+O*d,f[h]=o%u;return l&&(f=[l].concat(f)),f}function t(f,s,u,w){var o,a;if(u!=w)a=u>w?1:-1;else for(o=a=0;o<u;o++)if(f[o]!=s[o]){a=f[o]>s[o]?1:-1;break}return a}function r(f,s,u,w){for(var o=0;u--;)f[u]-=o,o=f[u]<s[u]?1:0,f[u]=o*w+f[u]-s[u];for(;!f[0]&&f.length>1;f.splice(0,1));}return function(f,s,u,w,o){var a,d,l,h,k,O,C,D,M,N,W,q,le,_e,ve,Q,ae,K=f.s==s.s?1:-1,H=f.c,x=s.c;if(!H||!H[0]||!x||!x[0])return new v(!f.s||!s.s||(H?x&&H[0]==x[0]:!x)?NaN:H&&H[0]==0||!x?K*0:K/0);for(D=new v(K),M=D.c=[],d=f.e-s.e,K=u+d+1,o||(o=Y,d=X(f.e/L)-X(s.e/L),K=K/L|0),l=0;x[l]==(H[l]||0);l++);if(x[l]>(H[l]||0)&&d--,K<0)M.push(1),h=!0;else{for(_e=H.length,Q=x.length,l=0,K+=2,k=V(o/(x[0]+1)),k>1&&(x=n(x,k,o),H=n(H,k,o),Q=x.length,_e=H.length),le=Q,N=H.slice(0,Q),W=N.length;W<Q;N[W++]=0);ae=x.slice(),ae=[0].concat(ae),ve=x[0],x[1]>=o/2&&ve++;do{if(k=0,a=t(x,N,Q,W),a<0){if(q=N[0],Q!=W&&(q=q*o+(N[1]||0)),k=V(q/ve),k>1)for(k>=o&&(k=o-1),O=n(x,k,o),C=O.length,W=N.length;t(O,N,C,W)==1;)k--,r(O,Q<C?ae:x,C,o),C=O.length,a=1;else k==0&&(a=k=1),O=x.slice(),C=O.length;if(C<W&&(O=[0].concat(O)),r(N,O,W,o),W=N.length,a==-1)for(;t(x,N,Q,W)<1;)k++,r(N,Q<W?ae:x,W,o),W=N.length}else a===0&&(k++,N=[0]);M[l++]=k,N[0]?N[W++]=H[le]||0:(N=[H[le]],W=1)}while((le++<_e||N[0]!=null)&&K--);h=N[0]!=null,M[0]||M.splice(0,1)}if(o==Y){for(l=1,K=M[0];K>=10;K/=10,l++);G(D,u+(D.e=l+d*L-1)+1,w,h)}else D.e=d,D.r=+h;return D}})();function ge(n,t,r,f){var s,u,w,o,a;if(r==null?r=c:T(r,0,8),!n.c)return n.toString();if(s=n.c[0],w=n.e,t==null)a=$(n.c),a=f==1||f==2&&(w<=_||w>=S)?de(a,w):ee(a,w,"0");else if(n=G(new v(n),t,r),u=n.e,a=$(n.c),o=a.length,f==1||f==2&&(t<=u||u<=_)){for(;o<t;a+="0",o++);a=de(a,u)}else if(t-=w+(f===2&&u>w),a=ee(a,u,"0"),u+1>o){if(--t>0)for(a+=".";t--;a+="0");}else if(t+=u-o,t>0)for(u+1==o&&(a+=".");t--;a+="0");return n.s<0&&s?"-"+a:a}function Se(n,t){for(var r,f,s=1,u=new v(n[0]);s<n.length;s++)f=new v(n[s]),(!f.s||(r=oe(u,f))===t||r===0&&u.s===t)&&(u=f);return u}function he(n,t,r){for(var f=1,s=t.length;!t[--s];t.pop());for(s=t[0];s>=10;s/=10,f++);return(r=f+r*L-1)>I?n.c=n.e=null:r<E?n.c=[n.e=0]:(n.e=r,n.c=t),n}i=(function(){var n=/^(-?)0([xbo])(?=\w[\w.]*$)/i,t=/^([^.]+)\.$/,r=/^\.([^.]+)$/,f=/^-?(Infinity|NaN)$/,s=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(u,w,o,a){var d,l=o?w:w.replace(s,"");if(f.test(l))u.s=isNaN(l)?null:l<0?-1:1;else{if(!o&&(l=l.replace(n,function(h,k,O){return d=(O=O.toLowerCase())=="x"?16:O=="b"?2:8,!a||a==d?k:h}),a&&(d=a,l=l.replace(t,"$1").replace(r,"0.$1")),w!=l))return new v(l,d);if(v.DEBUG)throw Error(j+"Not a"+(a?" base "+a:"")+" number: "+w);u.s=null}u.c=u.e=null}})();function G(n,t,r,f){var s,u,w,o,a,d,l,h=n.c,k=me;if(h){e:{for(s=1,o=h[0];o>=10;o/=10,s++);if(u=t-s,u<0)u+=L,w=t,a=h[d=0],l=V(a/k[s-w-1]%10);else if(d=ye((u+1)/L),d>=h.length)if(f){for(;h.length<=d;h.push(0));a=l=0,s=1,u%=L,w=u-L+1}else break e;else{for(a=o=h[d],s=1;o>=10;o/=10,s++);u%=L,w=u-L+s,l=w<0?0:V(a/k[s-w-1]%10)}if(f=f||t<0||h[d+1]!=null||(w<0?a:a%k[s-w-1]),f=r<4?(l||f)&&(r==0||r==(n.s<0?3:2)):l>5||l==5&&(r==4||f||r==6&&(u>0?w>0?a/k[s-w]:0:h[d-1])%10&1||r==(n.s<0?8:7)),t<1||!h[0])return h.length=0,f?(t-=n.e+1,h[0]=k[(L-t%L)%L],n.e=-t||0):h[0]=n.e=0,n;if(u==0?(h.length=d,o=1,d--):(h.length=d+1,o=k[L-u],h[d]=w>0?V(a/k[s-w]%k[w])*o:0),f)for(;;)if(d==0){for(u=1,w=h[0];w>=10;w/=10,u++);for(w=h[0]+=o,o=1;w>=10;w/=10,o++);u!=o&&(n.e++,h[0]==Y&&(h[0]=1));break}else{if(h[d]+=o,h[d]!=Y)break;h[d--]=0,o=1}for(u=h.length;h[--u]===0;h.pop());}n.e>I?n.c=n.e=null:n.e<E&&(n.c=[n.e=0])}return n}function Z(n){var t,r=n.e;return r===null?n.toString():(t=$(n.c),t=r<=_||r>=S?de(t,r):ee(t,r,"0"),n.s<0?"-"+t:t)}return e.absoluteValue=e.abs=function(){var n=new v(this);return n.s<0&&(n.s=1),n},e.comparedTo=function(n,t){return oe(this,new v(n,t))},e.decimalPlaces=e.dp=function(n,t){var r,f,s,u=this;if(n!=null)return T(n,0,z),t==null?t=c:T(t,0,8),G(new v(u),n+u.e+1,t);if(!(r=u.c))return null;if(f=((s=r.length-1)-X(this.e/L))*L,s=r[s])for(;s%10==0;s/=10,f--);return f<0&&(f=0),f},e.dividedBy=e.div=function(n,t){return y(this,new v(n,t),g,c)},e.dividedToIntegerBy=e.idiv=function(n,t){return y(this,new v(n,t),0,1)},e.exponentiatedBy=e.pow=function(n,t){var r,f,s,u,w,o,a,d,l,h=this;if(n=new v(n),n.c&&!n.isInteger())throw Error(j+"Exponent not an integer: "+Z(n));if(t!=null&&(t=new v(t)),o=n.e>14,!h.c||!h.c[0]||h.c[0]==1&&!h.e&&h.c.length==1||!n.c||!n.c[0])return l=new v(Math.pow(+Z(h),o?n.s*(2-pe(n)):+Z(n))),t?l.mod(t):l;if(a=n.s<0,t){if(t.c?!t.c[0]:!t.s)return new v(NaN);f=!a&&h.isInteger()&&t.isInteger(),f&&(h=h.mod(t))}else{if(n.e>9&&(h.e>0||h.e<-1||(h.e==0?h.c[0]>1||o&&h.c[1]>=24e7:h.c[0]<8e13||o&&h.c[0]<=9999975e7)))return u=h.s<0&&pe(n)?-0:0,h.e>-1&&(u=1/u),new v(a?1/u:u);F&&(u=ye(F/L+2))}for(o?(r=new v(.5),a&&(n.s=1),d=pe(n)):(s=Math.abs(+Z(n)),d=s%2),l=new v(p);;){if(d){if(l=l.times(h),!l.c)break;u?l.c.length>u&&(l.c.length=u):f&&(l=l.mod(t))}if(s){if(s=V(s/2),s===0)break;d=s%2}else if(n=n.times(r),G(n,n.e+1,1),n.e>14)d=pe(n);else{if(s=+Z(n),s===0)break;d=s%2}h=h.times(h),u?h.c&&h.c.length>u&&(h.c.length=u):f&&(h=h.mod(t))}return f?l:(a&&(l=p.div(l)),t?l.mod(t):u?G(l,F,c,w):l)},e.integerValue=function(n){var t=new v(this);return n==null?n=c:T(n,0,8),G(t,t.e+1,n)},e.isEqualTo=e.eq=function(n,t){return oe(this,new v(n,t))===0},e.isFinite=function(){return!!this.c},e.isGreaterThan=e.gt=function(n,t){return oe(this,new v(n,t))>0},e.isGreaterThanOrEqualTo=e.gte=function(n,t){return(t=oe(this,new v(n,t)))===1||t===0},e.isInteger=function(){return!!this.c&&X(this.e/L)>this.c.length-2},e.isLessThan=e.lt=function(n,t){return oe(this,new v(n,t))<0},e.isLessThanOrEqualTo=e.lte=function(n,t){return(t=oe(this,new v(n,t)))===-1||t===0},e.isNaN=function(){return!this.s},e.isNegative=function(){return this.s<0},e.isPositive=function(){return this.s>0},e.isZero=function(){return!!this.c&&this.c[0]==0},e.minus=function(n,t){var r,f,s,u,w=this,o=w.s;if(n=new v(n,t),t=n.s,!o||!t)return new v(NaN);if(o!=t)return n.s=-t,w.plus(n);var a=w.e/L,d=n.e/L,l=w.c,h=n.c;if(!a||!d){if(!l||!h)return l?(n.s=-t,n):new v(h?w:NaN);if(!l[0]||!h[0])return h[0]?(n.s=-t,n):new v(l[0]?w:c==3?-0:0)}if(a=X(a),d=X(d),l=l.slice(),o=a-d){for((u=o<0)?(o=-o,s=l):(d=a,s=h),s.reverse(),t=o;t--;s.push(0));s.reverse()}else for(f=(u=(o=l.length)<(t=h.length))?o:t,o=t=0;t<f;t++)if(l[t]!=h[t]){u=l[t]<h[t];break}if(u&&(s=l,l=h,h=s,n.s=-n.s),t=(f=h.length)-(r=l.length),t>0)for(;t--;l[r++]=0);for(t=Y-1;f>o;){if(l[--f]<h[f]){for(r=f;r&&!l[--r];l[r]=t);--l[r],l[f]+=Y}l[f]-=h[f]}for(;l[0]==0;l.splice(0,1),--d);return l[0]?he(n,l,d):(n.s=c==3?-1:1,n.c=[n.e=0],n)},e.modulo=e.mod=function(n,t){var r,f,s=this;return n=new v(n,t),!s.c||!n.s||n.c&&!n.c[0]?new v(NaN):!n.c||s.c&&!s.c[0]?new v(s):(R==9?(f=n.s,n.s=1,r=y(s,n,0,3),n.s=f,r.s*=f):r=y(s,n,0,R),n=s.minus(r.times(n)),!n.c[0]&&R==1&&(n.s=s.s),n)},e.multipliedBy=e.times=function(n,t){var r,f,s,u,w,o,a,d,l,h,k,O,C,D,M,N=this,W=N.c,q=(n=new v(n,t)).c;if(!W||!q||!W[0]||!q[0])return!N.s||!n.s||W&&!W[0]&&!q||q&&!q[0]&&!W?n.c=n.e=n.s=null:(n.s*=N.s,!W||!q?n.c=n.e=null:(n.c=[0],n.e=0)),n;for(f=X(N.e/L)+X(n.e/L),n.s*=N.s,a=W.length,h=q.length,a<h&&(C=W,W=q,q=C,s=a,a=h,h=s),s=a+h,C=[];s--;C.push(0));for(D=Y,M=te,s=h;--s>=0;){for(r=0,k=q[s]%M,O=q[s]/M|0,w=a,u=s+w;u>s;)d=W[--w]%M,l=W[w]/M|0,o=O*d+l*k,d=k*d+o%M*M+C[u]+r,r=(d/D|0)+(o/M|0)+O*l,C[u--]=d%D;C[u]=r}return r?++f:C.splice(0,1),he(n,C,f)},e.negated=function(){var n=new v(this);return n.s=-n.s||null,n},e.plus=function(n,t){var r,f=this,s=f.s;if(n=new v(n,t),t=n.s,!s||!t)return new v(NaN);if(s!=t)return n.s=-t,f.minus(n);var u=f.e/L,w=n.e/L,o=f.c,a=n.c;if(!u||!w){if(!o||!a)return new v(s/0);if(!o[0]||!a[0])return a[0]?n:new v(o[0]?f:s*0)}if(u=X(u),w=X(w),o=o.slice(),s=u-w){for(s>0?(w=u,r=a):(s=-s,r=o),r.reverse();s--;r.push(0));r.reverse()}for(s=o.length,t=a.length,s-t<0&&(r=a,a=o,o=r,t=s),s=0;t;)s=(o[--t]=o[t]+a[t]+s)/Y|0,o[t]=Y===o[t]?0:o[t]%Y;return s&&(o=[s].concat(o),++w),he(n,o,w)},e.precision=e.sd=function(n,t){var r,f,s,u=this;if(n!=null&&n!==!!n)return T(n,1,z),t==null?t=c:T(t,0,8),G(new v(u),n,t);if(!(r=u.c))return null;if(s=r.length-1,f=s*L+1,s=r[s]){for(;s%10==0;s/=10,f--);for(s=r[0];s>=10;s/=10,f++);}return n&&u.e+1>f&&(f=u.e+1),f},e.shiftedBy=function(n){return T(n,-Ee,Ee),this.times("1e"+n)},e.squareRoot=e.sqrt=function(){var n,t,r,f,s,u=this,w=u.c,o=u.s,a=u.e,d=g+4,l=new v("0.5");if(o!==1||!w||!w[0])return new v(!o||o<0&&(!w||w[0])?NaN:w?u:1/0);if(o=Math.sqrt(+Z(u)),o==0||o==1/0?(t=$(w),(t.length+a)%2==0&&(t+="0"),o=Math.sqrt(+t),a=X((a+1)/2)-(a<0||a%2),o==1/0?t="5e"+a:(t=o.toExponential(),t=t.slice(0,t.indexOf("e")+1)+a),r=new v(t)):r=new v(o+""),r.c[0]){for(a=r.e,o=a+d,o<3&&(o=0);;)if(s=r,r=l.times(s.plus(y(u,s,d,1))),$(s.c).slice(0,o)===(t=$(r.c)).slice(0,o))if(r.e<a&&--o,t=t.slice(o-3,o+1),t=="9999"||!f&&t=="4999"){if(!f&&(G(s,s.e+g+2,0),s.times(s).eq(u))){r=s;break}d+=4,o+=4,f=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(G(r,r.e+g+2,1),n=!r.times(r).eq(u));break}}return G(r,r.e+g+1,c,n)},e.toExponential=function(n,t){return n!=null&&(T(n,0,z),n++),ge(this,n,t,1)},e.toFixed=function(n,t){return n!=null&&(T(n,0,z),n=n+this.e+1),ge(this,n,t)},e.toFormat=function(n,t,r){var f,s=this;if(r==null)n!=null&&t&&typeof t=="object"?(r=t,t=null):n&&typeof n=="object"?(r=n,n=t=null):r=J;else if(typeof r!="object")throw Error(j+"Argument not an object: "+r);if(f=s.toFixed(n,t),s.c){var u,w=f.split("."),o=+r.groupSize,a=+r.secondaryGroupSize,d=r.groupSeparator||"",l=w[0],h=w[1],k=s.s<0,O=k?l.slice(1):l,C=O.length;if(a&&(u=o,o=a,a=u,C-=u),o>0&&C>0){for(u=C%o||o,l=O.substr(0,u);u<C;u+=o)l+=d+O.substr(u,o);a>0&&(l+=d+O.slice(u)),k&&(l="-"+l)}f=h?l+(r.decimalSeparator||"")+((a=+r.fractionGroupSize)?h.replace(new RegExp("\\d{"+a+"}\\B","g"),"$&"+(r.fractionGroupSeparator||"")):h):l}return(r.prefix||"")+f+(r.suffix||"")},e.toFraction=function(n){var t,r,f,s,u,w,o,a,d,l,h,k,O=this,C=O.c;if(n!=null&&(o=new v(n),!o.isInteger()&&(o.c||o.s!==1)||o.lt(p)))throw Error(j+"Argument "+(o.isInteger()?"out of range: ":"not an integer: ")+Z(o));if(!C)return new v(O);for(t=new v(p),d=r=new v(p),f=a=new v(p),k=$(C),u=t.e=k.length-O.e-1,t.c[0]=me[(w=u%L)<0?L+w:w],n=!n||o.comparedTo(t)>0?u>0?t:d:o,w=I,I=1/0,o=new v(k),a.c[0]=0;l=y(o,t,0,1),s=r.plus(l.times(f)),s.comparedTo(n)!=1;)r=f,f=s,d=a.plus(l.times(s=d)),a=s,t=o.minus(l.times(s=t)),o=s;return s=y(n.minus(r),f,0,1),a=a.plus(s.times(d)),r=r.plus(s.times(f)),a.s=d.s=O.s,u=u*2,h=y(d,f,u,c).minus(O).abs().comparedTo(y(a,r,u,c).minus(O).abs())<1?[d,f]:[a,r],I=w,h},e.toNumber=function(){return+Z(this)},e.toPrecision=function(n,t){return n!=null&&T(n,1,z),ge(this,n,t,2)},e.toString=function(n){var t,r=this,f=r.s,s=r.e;return s===null?f?(t="Infinity",f<0&&(t="-"+t)):t="NaN":(n==null?t=s<=_||s>=S?de($(r.c),s):ee($(r.c),s,"0"):n===10&&we?(r=G(new v(r),g+s+1,c),t=ee($(r.c),r.e,"0")):(T(n,2,re.length,"Base"),t=A(ee($(r.c),s,"0"),10,n,f,!0)),f<0&&r.c[0]&&(t="-"+t)),t},e.valueOf=e.toJSON=function(){return Z(this)},e._isBigNumber=!0,e[Symbol.toStringTag]="BigNumber",e[Symbol.for("nodejs.util.inspect.custom")]=e.valueOf,m!=null&&v.set(m),v}function X(m){var y=m|0;return m>0||m===y?y:y-1}function $(m){for(var y,A,i=1,e=m.length,p=m[0]+"";i<e;){for(y=m[i++]+"",A=L-y.length;A--;y="0"+y);p+=y}for(e=p.length;p.charCodeAt(--e)===48;);return p.slice(0,e+1||1)}function oe(m,y){var A,i,e=m.c,p=y.c,g=m.s,c=y.s,_=m.e,S=y.e;if(!g||!c)return null;if(A=e&&!e[0],i=p&&!p[0],A||i)return A?i?0:-c:g;if(g!=c)return g;if(A=g<0,i=_==S,!e||!p)return i?0:!e^A?1:-1;if(!i)return _>S^A?1:-1;for(c=(_=e.length)<(S=p.length)?_:S,g=0;g<c;g++)if(e[g]!=p[g])return e[g]>p[g]^A?1:-1;return _==S?0:_>S^A?1:-1}function T(m,y,A,i){if(m<y||m>A||m!==V(m))throw Error(j+(i||"Argument")+(typeof m=="number"?m<y||m>A?" out of range: ":" not an integer: ":" not a primitive number: ")+String(m))}function pe(m){var y=m.c.length-1;return X(m.e/L)==y&&m.c[y]%2!=0}function de(m,y){return(m.length>1?m.charAt(0)+"."+m.slice(1):m)+(y<0?"e":"e+")+y}function ee(m,y,A){var i,e;if(y<0){for(e=A+".";++y;e+=A);m=e+m}else if(i=m.length,++y>i){for(e=A,y-=i;--y;e+=A);m+=e}else y<i&&(m=m.slice(0,y)+"."+m.slice(y));return m}var Ve=We(),Le=function(m,y,A){var i=m.filter(function(p){return p.accountId===y.accountId&&p.accountTokenId}),e=A.tokens.length?A.tokens.filter(function(p){return i.find(function(g){return g.contract===p.contract})}).map(function(p){var g=(function(c){for(var _=1;_<arguments.length;_++){var S=arguments[_]!=null?arguments[_]:{},E=Object.keys(S);typeof Object.getOwnPropertySymbols=="function"&&(E=E.concat(Object.getOwnPropertySymbols(S).filter(function(I){return Object.getOwnPropertyDescriptor(S,I).enumerable}))),E.forEach(function(I){var b;b=S[I],I in c?Object.defineProperty(c,I,{value:b,enumerable:!0,configurable:!0,writable:!0}):c[I]=b})}return c})({},p);return delete g.tokenId,delete g.decimals,g.balance=Ne(p.balance,p.decimals),g}):[];return{network:y.network,address:y.address,balance:Ne(A.balance,A.decimals),symbol:y.symbol,tokens:e}},Xe=Ve.clone({DECIMAL_PLACES:40}),Ne=function(m,y){if(!y||!m)return"0";var A=new Xe(m).shiftedBy(-y).toFixed();return A==="NaN"?"0":A},Ye=function(m){var y=[];return m?.length&&(y=m.map(function(A){return A.contract&&A.accountTokenId?{network:A.network,address:A.address,contract:A.contract}:{network:A.network,address:A.address}})),y},Je=function(m,y){var A=m.accounts,i=m.aa_accounts;return y?i?A.concat(i):A:A.map(function(e){return i?.find(function(p){return p.coinId===e.coinId&&p?.contract===e?.contract&&p?.eoaAddress===e.address})||e})};function ce(m,y,A){return y in m?Object.defineProperty(m,y,{value:A,enumerable:!0,configurable:!0,writable:!0}):m[y]=A,m}var se=function m(){(function(y,A){if(!(y instanceof A))throw TypeError("Cannot call a class as a function")})(this,m)};ce(se,"test",console.warn.bind(window.console,"[SDK][test] ")),ce(se,"warn",console.warn.bind(window.console,"[SDK][warn] ")),ce(se,"error",console.error.bind(window.console,"[SDK][error] ")),ce(se,"todo",console.warn.bind(window.console,"[SDK][todo] ")),ce(se,"assert",console.assert.bind(window.console));function Ce(m,y,A,i,e,p,g){try{var c=m[p](g),_=c.value}catch(S){A(S);return}c.done?y(_):Promise.resolve(_).then(i,e)}function P(m){return function(){var y=this,A=arguments;return new Promise(function(i,e){var p=m.apply(y,A);function g(_){Ce(p,i,e,g,c,"next",_)}function c(_){Ce(p,i,e,g,c,"throw",_)}g(void 0)})}}function B(m,y,A){return y in m?Object.defineProperty(m,y,{value:A,enumerable:!0,configurable:!0,writable:!0}):m[y]=A,m}function Ae(m){return(Ae=Object.setPrototypeOf?Object.getPrototypeOf:function(y){return y.__proto__||Object.getPrototypeOf(y)})(m)}function Re(m,y){return(Re=Object.setPrototypeOf||function(A,i){return A.__proto__=i,A})(m,y)}function Te(){try{var m=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Te=function(){return!!m})()}function U(m,y){var A,i,e,p,g={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return p={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(p[Symbol.iterator]=function(){return this}),p;function c(_){return function(S){return(function(E){if(A)throw TypeError("Generator is already executing.");for(;g;)try{if(A=1,i&&(e=2&E[0]?i.return:E[0]?i.throw||((e=i.return)&&e.call(i),0):i.next)&&!(e=e.call(i,E[1])).done)return e;switch(i=0,e&&(E=[2&E[0],e.value]),E[0]){case 0:case 1:e=E;break;case 4:return g.label++,{value:E[1],done:!1};case 5:g.label++,i=E[1],E=[0];continue;case 7:E=g.ops.pop(),g.trys.pop();continue;default:if(!(e=(e=g.trys).length>0&&e[e.length-1])&&(E[0]===6||E[0]===2)){g=0;continue}if(E[0]===3&&(!e||E[1]>e[0]&&E[1]<e[3])){g.label=E[1];break}if(E[0]===6&&g.label<e[1]){g.label=e[1],e=E;break}if(e&&g.label<e[2]){g.label=e[2],g.ops.push(E);break}e[2]&&g.ops.pop(),g.trys.pop();continue}E=y.call(m,g)}catch(I){E=[6,I],i=0}finally{A=e=0}if(5&E[0])throw E[1];return{value:E[0]?E[1]:void 0,done:!0}})([_,S])}}}var en=(function(m){var y;function A(i){var e,p,g,c,_=i.appId,S=i.appKey,E=i.wepinModal,I=i.wepinStorage;return(function(b,R){if(!(b instanceof R))throw TypeError("Cannot call a class as a function")})(this,A),p=Ae(p=A),B(c=(e=Te()?Reflect.construct(p,[],Ae(this).constructor):p.apply(this,g))&&((e&&typeof Symbol<"u"&&e.constructor===Symbol?"symbol":typeof e)=="object"||typeof e=="function")?e:(function(b){if(b===void 0)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return b})(this),"version",void 0),B(c,"type",void 0),B(c,"wepinAppAttributes",void 0),B(c,"wepinDomain",void 0),B(c,"specifiedEmail",void 0),B(c,"_wepinLifeCycle",void 0),B(c,"_isInitialized",void 0),B(c,"_modeByAppKey",void 0),B(c,"_wepinAppId",void 0),B(c,"_wepinAppKey",void 0),B(c,"_widget",void 0),B(c,"_wepinModal",void 0),B(c,"_wepinStorage",void 0),B(c,"_wepinFetch",void 0),B(c,"_accountInfo",void 0),B(c,"_detailAccount",void 0),B(c,"_userInfo",void 0),B(c,"webviewEventHandler",void 0),B(c,"_loginRejectCallback",null),B(c,"wepinRequest",void 0),c.version=Ke,console.log("WepinWeb SDK v".concat(c.version)),c._isInitialized=!1,c.wepinLifeCycle="not_initialized",c._wepinAppId=_,c._wepinAppKey=S,c._wepinModal=E||new Ue,c._wepinStorage=I||new De,c.type=c._wepinStorage.platform,c._modeByAppKey=xe(S),c.webviewEventHandler=new Be({checkValidEvent:function(b){return!!(c.wepinWidget.url.includes("/wepin-sdk-login")||c.wepinWidget.url.includes(b.origin))||b.origin===c.wepinWidget.url}}),c.initEventHandler(),c}return(function(i,e){if(typeof e!="function"&&e!==null)throw TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),e&&Re(i,e)})(A,m),y=[{key:"initEventHandler",value:function(){var i,e,p=this;e=this._wepinAppKey.slice(0,13)==="local_ak_dev_"?this._wepinAppKey.slice(6):this._wepinAppKey,this.webviewEventHandler.addRequestHandler("ready_to_widget",function(c){p.wepinStorage.getAllLocalStorage(p._wepinAppId).then(function(_){var S,E,I,b=Object.assign({},p.wepinAppAttributes),R=!((S=p.wepinAppAttributes.loginProviders)===null||S===void 0)&&S.length||((E=p.wepinAppAttributes.loginProviders)===null||E===void 0?void 0:E.length)===0?Array.from(p.wepinAppAttributes.loginProviders):void 0;b.loginProviders=R;var F=ue(c,"SUCCESS",{appKey:e,appId:p._wepinAppId,domain:p.wepinDomain,platform:Me[p.type],attributes:b,version:p.version.includes("-alpha")?p.version.substring(0,p.version.indexOf("-")):p.version,type:"".concat(p.type,"-sdk"),localDate:_??{}});!((I=p.wepinWidget)===null||I===void 0)&&I.isOpen&&p.wepinWidget.response(F)})}),this.webviewEventHandler.addRequestHandler("close_wepin_widget",function(){if(p._loginRejectCallback){var c=p._loginRejectCallback;p._loginRejectCallback=null,c(Error("User canceled login"))}p.wepinWidget&&(p.wepinWidget.close(),p.wepinWidget=void 0)});var g=this;this.webviewEventHandler.addRequestHandler("set_local_storage",(i=P(function(c){var _,S,E,I,b;return U(this,function(R){switch(R.label){case 0:return[4,g.wepinStorage.setAllLocalStorage(g._wepinAppId,c.body.parameter.data)];case 1:return R.sent(),c.body.parameter.data&&c.body.parameter.data.user_info&&(E=c.body.parameter.data.user_info,I=c.body.parameter.data.user_status,E.userStatus=I,E.token=(S=c.body.parameter.data)===null||S===void 0?void 0:S["wepin:connectUser"],g.setUserInfo(E,!0)),c.body.parameter.data&&c.body.parameter.data["wepin:connectUser"]?[4,g.setToken(c.body.parameter.data["wepin:connectUser"])]:[3,3];case 2:R.sent(),R.label=3;case 3:return b=ue(c,"SUCCESS",""),!((_=g.wepinWidget)===null||_===void 0)&&_.isOpen&&g.wepinWidget.response(b),[2]}})}),function(c){return i.apply(this,arguments)})),this.webviewEventHandler.addRequestHandler("set_user_email",function(c){var _,S=ue(c,"SUCCESS",{email:p.specifiedEmail});!((_=p.wepinWidget)===null||_===void 0)&&_.isOpen&&p.wepinWidget.response(S)})}},{key:"wepinLifeCycle",get:function(){return this._wepinLifeCycle},set:function(i){if(i!==this._wepinLifeCycle){if(this._wepinLifeCycle=i,this._wepinLifeCycle==="login"||this._wepinLifeCycle==="login_before_register"){this.emit(ie.WEPIN_LIFECYCLE_CHANGE,i,this._userInfo);return}this.emit(ie.WEPIN_LIFECYCLE_CHANGE,i)}}},{key:"modeByAppKey",get:function(){if(this._modeByAppKey===void 0)throw Error("Wepin.modeByAppKey: wepin widget has to be initialized");return this._modeByAppKey}},{key:"toJSON",value:function(){return""}},{key:"wepinStorage",get:function(){return this._wepinStorage}},{key:"init",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{type:"hide",defaultLanguage:ke,defaultCurrency:be},e=this;return P(function(){var p,g,c,_,S,E;return U(this,function(I){switch(I.label){case 0:if(e._isInitialized)throw Error("Wepin is already initialized!");if(p=i.loginProviders,g=i.defaultLanguage,c=i.defaultCurrency,_=i.type,p&&!p.every(function(b){return je.includes(b)}))throw Error("Invalid Login provider");return e.wepinAppAttributes={type:_??"hide",defaultLanguage:g??ke,defaultCurrency:c??be,loginProviders:p},e.wepinDomain=e._wepinModal.domain,e._isInitialized=!1,e.wepinLifeCycle="initializing",e._wepinFetch=new qe({appId:e._wepinAppId,appKey:e._wepinAppKey,domain:e.wepinDomain,sdk:{version:e.version,type:"".concat(e.type,"-sdk")},storage:e._wepinStorage}),[4,e._wepinFetch.init()];case 1:return I.sent(),[4,e._wepinFetch.wepinApi.app.getAppInfo({platform:ze[e.type],withNetwork:!1})];case 2:if(ne(S=I.sent()))throw Error(S.message);return e._wepinAppId=e._wepinFetch.appId=S.appInfo.id,[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"wepin:connectUser")];case 3:return(E=I.sent())?[4,e._wepinFetch.setToken(E)]:[3,5];case 4:I.sent(),I.label=5;case 5:return e._isInitialized=!0,[4,e.checkExpiredToken()];case 6:return I.sent(),[2]}})})()}},{key:"wepinWidget",get:function(){return this._widget},set:function(i){this._widget=i}},{key:"isInitialized",value:function(){return!!this._isInitialized}},{key:"changeLanguage",value:function(i){var e=i.currency,p=i.language;this.wepinAppAttributes.defaultCurrency=e,this.wepinAppAttributes.defaultLanguage=p}},{key:"openWidget",value:function(){var i=this;return P(function(){return U(this,function(e){switch(e.label){case 0:return[4,i.getStatus()];case 1:if(e.sent()!=="login")throw Error("Wepin.openWidget: You can open it only if you are logged in to the wepin.");return[4,i.openWithoutRequestWepinWidget()];case 2:return e.sent(),[2]}})})()}},{key:"_open",value:function(i){var e=this;return P(function(){var p,g;return U(this,function(c){switch(c.label){case 0:return c.trys.push([0,7,,8]),p=Fe(e._modeByAppKey).wepinWebview,e._widget&&e._widget.isOpen?[2]:(i?.url&&(p+=i.url),i?.isHide||e.wepinAppAttributes.type!=="show"&&i?.isInit?[4,e._wepinModal.openModal(p,e.webviewEventHandler.getEventListenerFunction(),{isHide:!0})]:[3,2]);case 1:case 3:return e._widget=c.sent(),[3,6];case 2:return i?.type!=="WINDOW"?[3,4]:[4,e._wepinModal.openAuthBrowser(p,e.webviewEventHandler.getEventListenerFunction())];case 4:return[4,e._wepinModal.openModal(p,e.webviewEventHandler.getEventListenerFunction())];case 5:e._widget=c.sent(),c.label=6;case 6:return[3,8];case 7:throw g=c.sent(),se.error(g),Error("Wepin.openWidget: Can't open wepin sdk widget");case 8:return[2]}})})()}},{key:"openWithoutRequestWepinWidget",value:function(i){var e,p=this;return new Promise((e=P(function(g){return U(this,function(c){return p.webviewEventHandler.addRequestHandler("get_sdk_request",function(_){var S=ue(Ie(_),"SUCCESS","No request");p._widget.response(S),g()},!0),p._open(i),[2]})}),function(g){return e.apply(this,arguments)}))}},{key:"openAndRequestWepinWidget",value:function(i,e){var p,g=Date.now()+Math.random(),c={header:{id:g,request_from:"web",request_to:"wepin_widget"},body:i},_=this;return new Promise((p=P(function(S,E){return U(this,function(I){return _.webviewEventHandler.addRequestHandler("get_sdk_request",function(b){var R,F=ue(Ie(b),"SUCCESS",i?c:"No request");!((R=_._widget)===null||R===void 0)&&R.isOpen&&(_.webviewEventHandler.addResponseHandler(g.toString(),function(J){if(_._close(),J.body.state==="ERROR"){E(Error(J.body.data));return}S(J)},!0),_._widget.response(F))},!0),_._open(e),[2]})}),function(S,E){return p.apply(this,arguments)}))}},{key:"closeWidget",value:function(){if(!this._isInitialized)throw Error("Wepin.closeWidget: wepin sdk has to be initialized");if(this._widget)this._close();else throw Error("Wepin.closeWidget: wepin sdk widget is not exist")}},{key:"_close",value:function(){var i=this;return P(function(){return U(this,function(e){switch(e.label){case 0:return i.removeAllListeners("onUserInfoSet"),i.wepinRequest&&i.removeAllListeners(i.wepinRequest.header.id.toString()),i._loginRejectCallback=null,i._widget?[4,i._widget.close()]:[3,2];case 1:e.sent(),i._widget=void 0,e.label=2;case 2:return i.specifiedEmail=void 0,[2]}})})()}},{key:"setToken",value:function(i){var e=this;return P(function(){return U(this,function(p){switch(p.label){case 0:return[4,e._wepinFetch.setToken(i)];case 1:return p.sent(),[2]}})})()}},{key:"checkExpiredToken",value:function(){var i=this;return P(function(){var e,p,g;return U(this,function(c){switch(c.label){case 0:return c.trys.push([0,8,,9]),[4,i._wepinStorage.getLocalStorage(i._wepinAppId,"wepin:connectUser")];case 1:return(e=c.sent())?He(e.accessToken).exp<Math.floor(Date.now()/1e3)+60?[4,i._wepinFetch.setToken(e)]:[3,6]:(i.wepinLifeCycle="initialized",[2,!0]);case 2:return c.sent(),[4,i._wepinStorage.getLocalStorage(i._wepinAppId,"user_id")];case 3:return p=c.sent(),[4,i._wepinFetch.wepinApi.user.refreshToken({userId:p})];case 4:return ne(g=c.sent())?(i.wepinLifeCycle="initialized",[2,!0]):(e.accessToken=g.token,[4,i._wepinStorage.setLocalStorage(i._wepinAppId,"wepin:connectUser",e)]);case 5:c.sent(),c.label=6;case 6:return[4,i.getWepinUserInfo()];case 7:return c.sent(),[2,!1];case 8:return c.sent(),[2,!0];case 9:return[2]}})})()}},{key:"loginWithUI",value:function(i){var e=this;return P(function(){var p,g;return U(this,function(c){switch(c.label){case 0:if(!e._isInitialized)throw Error("Wepin.loginWithUI: wepin sdk has to be initialized");return[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"wepin:connectUser")];case 1:return p=c.sent(),[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"user_info")];case 2:if(g=c.sent(),i?.email){if(!Ge.test(i?.email))throw Error("Wepin.loginWithUI: The email does not match the correct format.");e.specifiedEmail=i?.email}else e.specifiedEmail=void 0;return e.wepinLifeCycle="before_login",p&&g?g&&p?.refreshToken&&i?.email&&g?.userInfo.email!==i?.email?[4,e.logout()]:[3,4]:[3,6];case 3:c.sent(),c.label=4;case 4:return p?.refreshToken?[4,e.checkExpiredToken()]:[3,6];case 5:if(!c.sent()&&g&&g.status==="success")return[2,e._userInfo];c.label=6;case 6:return[4,e.openWithoutRequestWepinWidget()];case 7:return c.sent(),[2,new Promise(function(_,S){e._loginRejectCallback=S,e.once("onUserInfoSet",P(function(){var E,I;return U(this,function(b){switch(b.label){case 0:return b.trys.push([0,4,,5]),e._loginRejectCallback=null,[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"wepin:connectUser")];case 1:return E=b.sent(),e._close(),e.specifiedEmail=void 0,E?[4,e._wepinFetch.setToken(E)]:(S(Error("User canceled login")),[2]);case 2:return b.sent(),[4,e.getWepinUserInfo()];case 3:return b.sent(),_(e._userInfo),[3,5];case 4:return I=b.sent(),e._loginRejectCallback=null,S(Error(I)),[3,5];case 5:return[2]}})}))})]}})})()}},{key:"getWepinUserInfo",value:function(i){var e=this;return P(function(){var p,g,c;return U(this,function(_){switch(_.label){case 0:return[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"user_info")];case 1:return p=_.sent(),[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"user_status")];case 2:return g=_.sent(),[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"wepin:connectUser")];case 3:return c=_.sent(),i?(p.walletId=i,[4,e._wepinStorage.setLocalStorage(e._wepinAppId,"user_status",{loginStatus:"complete"})]):[3,8];case 4:return _.sent(),[4,e._wepinStorage.setLocalStorage(e._wepinAppId,"user_info",p)];case 5:return _.sent(),[4,e._wepinStorage.setLocalStorage(e._wepinAppId,"wallet_id",i)];case 6:return _.sent(),[4,e._wepinStorage.setLocalStorage(e._wepinAppId,"user_status",{loginStatus:"complete"})];case 7:_.sent(),_.label=8;case 8:return e._userInfo=Object.assign(p,{userStatus:g,token:c}),p&&p.status==="success"?g&&g.loginStatus==="complete"?e.wepinLifeCycle="login":e.wepinLifeCycle="login_before_register":e.wepinLifeCycle="initialized",[2,e._userInfo]}})})()}},{key:"register",value:function(){var i=this;return P(function(){var e,p,g,c,_,S,E,I;return U(this,function(b){switch(b.label){case 0:if(!i._isInitialized)throw Error("Wepin.register: wepin sdk has to be initialized");return[4,i._wepinStorage.getLocalStorage(i._wepinAppId,"user_status")];case 1:return((e=b.sent()).loginStatus==="registerRequired"||e.loginStatus==="pinRequired")&&i.wepinLifeCycle,[4,i.getStatus()];case 2:if(b.sent()!=="login_before_register")throw Error("Wepin.register: The LifeCycle of wepin sdk has to be login_before_register");if(e.loginStatus!=="registerRequired"&&e.loginStatus!=="pinRequired")throw Error("Wepin.register: invalid login status");return e.loginStatus==="registerRequired"&&!e.pinRequired?[4,i._wepinStorage.getLocalStorage(i._wepinAppId,"user_id")]:[3,8];case 3:return p=b.sent(),[4,i._wepinStorage.getLocalStorage(i._wepinAppId,"wallet_id")];case 4:return g=b.sent(),[4,i._wepinFetch.wepinApi.app.register({appId:i._wepinAppId,userId:p,walletId:g,loginStatus:e.loginStatus})];case 5:if(ne(c=b.sent()))throw Error(c.message);return[4,i._wepinFetch.wepinApi.user.updateTermsAccepted({userId:p},{termsAccepted:{termsOfService:!0,privacyPolicy:!0}})];case 6:if(ne(_=b.sent())||!Object.values(_.termsAccepted).every(function(R){return R===!0}))throw Error("unknown/updateTermsAccepted");return[4,i.getWepinUserInfo(c.walletId)];case 7:case 10:return[2,b.sent()];case 8:return[4,i.openAndRequestWepinWidget({command:"register_wepin",parameter:{loginStatus:e.loginStatus,pinRequired:e.pinRequired}},{url:"/sdk-register"})];case 9:return(S=b.sent()).body.state!=="SUCCESS"?[3,11]:(I=(E=S.body.data)===null||E===void 0?void 0:E.walletId,[4,i.getWepinUserInfo(I)]);case 11:throw S.body.data?Error("Wepin.register: ".concat(S.body.data)):Error("unknown/error");case 12:return[2]}})})()}},{key:"registerUserEmail",value:function(i){var e=this;return P(function(){return U(this,function(p){return[2,new Promise(function(g,c){e.once("onUserInfoSet",function(_){e._close(),g(_)}),e.openAndRequestWepinWidget({command:"register_user_email",parameter:{provider:i.provider,idToken:i.idToken,accessToken:i.accessToken}}).catch(c)})]})})()}},{key:"logout",value:function(){var i=this;return P(function(){var e;return U(this,function(p){switch(p.label){case 0:return i._loginRejectCallback=null,[4,i.getStatus()];case 1:if(e=p.sent(),!i._isInitialized)throw Error("Wepin.logout: wepin sdk has to be initialized");if(e!=="login"&&e!=="login_before_register")throw Error("Wepin.logout: Only if you're logged in to the wepin");return[4,i._wepinStorage.clearAllLocalStorage(i._wepinAppId)];case 2:return p.sent(),i.wepinLifeCycle="initialized",i._userInfo=void 0,i._accountInfo=void 0,i._detailAccount=void 0,[2]}})})()}},{key:"getAccounts",value:function(i){var e=this;return P(function(){var p,g,c;return U(this,function(_){switch(_.label){case 0:if(!e._isInitialized)throw Error("Wepin.getAccounts: wepin sdk has to be initialized");return[4,e.getStatus()];case 1:if(_.sent()!=="login")throw Error("Wepin.getAccounts: Only if you're logged in to the wepin");return[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"user_id")];case 2:return p=_.sent(),[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"wallet_id")];case 3:return g=_.sent(),[4,e._wepinFetch.wepinApi.account.getAppAccountList({userId:p,walletId:g,localeId:e.wepinAppAttributes.defaultLanguage==="ko"?1:e.wepinAppAttributes.defaultLanguage==="ja"?3:2})];case 4:if(ne(c=_.sent()))throw Error(c.message);return e._detailAccount=Je(c,i?.withEoa),e._accountInfo=Ye(e._detailAccount),i?.networks!==void 0&&i?.networks.length>0?[2,e._accountInfo.filter(function(S){return i?.networks.findIndex(function(E){return E===S.network})>=0})]:[2,e._accountInfo]}})})()}},{key:"setUserInfo",value:function(i,e){this._userInfo=i,i&&i.status==="success"?i.userStatus&&i.userStatus.loginStatus==="complete"?this.wepinLifeCycle="login":this.wepinLifeCycle="login_before_register":this.wepinLifeCycle="initialized",e&&this.emit("onUserInfoSet",i)}},{key:"getStatus",value:function(){var i=this;return P(function(){return U(this,function(e){switch(e.label){case 0:return[4,i.checkExpiredToken()];case 1:return e.sent(),[2,i.wepinLifeCycle]}})})()}},{key:"getBalance",value:function(i){var e=this;return P(function(){var p,g,c;return U(this,function(_){var S,E;switch(_.label){case 0:if(!e._isInitialized)throw Error("Wepin.getBalance: wepin sdk has to be initialized");return[4,e.getStatus()];case 1:if(_.sent()!=="login")throw Error("Wepin.getBalance: Only if you're logged in to the wepin.");return p=!i||i.length===0,[4,e.getAccounts()];case 2:return _.sent(),p?[4,Promise.all(e._detailAccount.map((S=P(function(I){var b;return U(this,function(R){switch(R.label){case 0:return[4,e._wepinFetch.wepinApi.balance.getAccountBalance({accountId:I.accountId})];case 1:if(ne(b=R.sent()))throw Error(b.message);return[2,Le(e._detailAccount,I,b)]}})}),function(I){return S.apply(this,arguments)})))]:[3,4];case 3:if(!(g=_.sent()).length)throw Error("Wepin.getBalance: Account not found");return[2,g];case 4:return[4,Promise.all(i.map((E=P(function(I){var b,R;return U(this,function(F){switch(F.label){case 0:if(!(b=e._detailAccount.find(function(J){return I.network===J.network&&I.address===J.address})))throw Error("Wepin.getBalance: Account not found");return[4,e._wepinFetch.wepinApi.balance.getAccountBalance({accountId:b.accountId})];case 1:if(ne(R=F.sent()))throw Error(R.message);return[2,Le(e._detailAccount,b,R)]}})}),function(I){return E.apply(this,arguments)})))];case 5:if(!(c=_.sent()).length)throw Error("Wepin.getBalance: Account not found");return[2,c];case 6:return[2]}})})()}},{key:"getSDKRequest",value:function(){return this.wepinRequest}},{key:"send",value:function(i){var e=i.account,p=i.txData,g=this;return P(function(){var c,_,S;return U(this,function(E){switch(E.label){case 0:if(!g._isInitialized)throw Error("Wepin.send: wepin sdk has to be initialized");return[4,g.getStatus()];case 1:if(E.sent()!=="login")throw Error("Wepin.send: Only if you're logged in to the wepin");return g.emit(ie.SEND_IN_PROGRESS),[4,g.getAccounts()];case 2:if(E.sent(),!g._detailAccount.find(function(I){return e.network===I.network&&e.address===I.address}))throw g.emit(ie.SEND_COMPLETE,!1,"Account not found"),Error("Wepin.send: Account not found");return[4,g.openAndRequestWepinWidget({command:"send_transaction_without_provider",parameter:{account:{address:e.address,network:e.network,contract:e?.contract},from:e.address,to:p?.toAddress,value:p?.amount}},{url:"/sdk-send"})];case 3:if(_=(c=E.sent()).body.state==="SUCCESS",g.wepinRequest=void 0,_)return S=c.body.data,g.emit(ie.SEND_COMPLETE,_,S),[2,{txId:S}];throw c.body.data?(g.emit(ie.SEND_COMPLETE,_,c.body.data),Error("Wepin.send: ".concat(c.body.data))):(g.emit(ie.SEND_COMPLETE,_,"unknown/error"),Error("unknown/error"))}})})()}},{key:"getLoginSession",value:function(i){var e=this;return P(function(){var p,g,c,_,S;return U(this,function(E){switch(E.label){case 0:return i?(p=i.firebaseToken,[4,e._wepinFetch.wepinFirebaseApi.getRefreshIdToken(p.refreshToken)]):[3,4];case 1:return g=E.sent(),[4,e._wepinFetch.wepinApi.user.login({idToken:g})];case 2:if(ne(c=E.sent()))throw Error("Wepin.getLoginSession: wepin login fail");return[4,e._wepinStorage.setLoginUserLocalStorage(e._wepinAppId,{provider:p.provider,token:{idToken:g,refreshToken:p.refreshToken}},c)];case 3:E.sent(),E.label=4;case 4:return[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"firebase:wepin")];case 5:return _=E.sent(),[4,e._wepinStorage.getLocalStorage(e._wepinAppId,"wepin:connectUser")];case 6:return S=E.sent(),[2,{firebaseToken:_,wepinToken:S}]}})})()}},{key:"finalize",value:function(){var i=this;return P(function(){return U(this,function(e){switch(e.label){case 0:return[4,i._close()];case 1:return e.sent(),[4,i._wepinStorage.clearAllLocalStorage(i._wepinAppId)];case 2:return e.sent(),i._isInitialized=!1,i.wepinLifeCycle="not_initialized",i._userInfo=void 0,i._accountInfo=void 0,i._detailAccount=void 0,i.specifiedEmail=void 0,[2]}})})()}}],(function(i,e){for(var p=0;p<e.length;p++){var g=e[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(i,g.key,g)}})(A.prototype,y),A})(Pe);export{ie as WEPIN_SDK_EVENTS,en as WepinSDK};
